# -------------------------------------------------------------------
#                         Nginx configuraiton
# -------------------------------------------------------------------

worker_processes    1;

error_log		stderr	info;
pid             /var/run/nginx.pid;

events {
    use	epoll;
}

http {
    include     /etc/nginx/mime.types;
    
    upstream apis_proxy {
        server apis:8000;		# nodejs server
    }

    server {
        listen          80;
        listen          [::]:80;
        server_name     sc.lagobe.com dev.sc.lagobe.com *.ap-southeast-1.elasticbeanstalk.com;
        root            /usr/share/nginx/html;
        
        location /apis/ {
            proxy_pass  http://apis_proxy/;
        }
        
        location / {
            try_files   $uri $uri/ /index.html =404;
        }
    }
    
    server {
        listen          80;
        listen          [::]:80;
        server_name     lagobe.com www.lagobe.com sellercenter.lagobe.com;
        return          301 http://sc.lagobe.com$request_uri;
    }
    
#    server {
#		listen          443;
#        listen          [::]:443;
#		server_name     sc.lagobe.com dev.sc.lagobe.com *.ap-southeast-1.elasticbeanstalk.com;
#
#		ssl on;
#		ssl_certificate /etc/letsencrypt/live/___my.example.com___/fullchain.pem;
#		ssl_certificate_key /etc/letsencrypt/live/___my.example.com___/privkey.pem;
#		ssl_session_timeout 5m;
#		ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
#		ssl_ciphers 'EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH';
#		ssl_prefer_server_ciphers on;
#
#		ssl_session_cache shared:SSL:10m;
#		ssl_dhparam /etc/ssl/private/dhparams.pem;
#
#		location /.well-known/acme-challenge {
#			proxy_pass http://___LETSENCRYPT_HTTPS_IP___:___LETSENCRYPT_HTTPS_PORT___;
#			proxy_set_header Host            $host;
#			proxy_set_header X-Forwarded-For $remote_addr;
#			proxy_set_header X-Forwarded-Proto https;
#		}
#
#		location / {
#			proxy_pass http://___APPLICATION_IP___:___APPLICATION_PORT___;
#			proxy_set_header Host            $host;
#			proxy_set_header X-Forwarded-For $remote_addr;
#		}
#	}
}